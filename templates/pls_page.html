{% extends 'base.html' %}
{% block title %}Participation Consent (PLS){% endblock %}

{% block content %}
<div class="card shadow-sm mx-auto" style="max-width: 800px;">
  <div class="card-header text-center">
    <h2>Participation Consent</h2>
  </div>
  <div class="card-body">
    <div id="pdfContainer" style="overflow-y: auto; height: 600px; border: 1px solid #4F959D; border-radius: 15px;">
      <!-- Adjust the path to your PLS PDF file -->
      <iframe src="{{ url_for('static', filename='pls.pdf') }}" width="100%" height="100%" style="border: none;"></iframe>
    </div>
    <p class="mt-3 text-center">
      By clicking "Agree", you consent to participate in the study. You may withdraw at any time.
    </p>
    <div class="text-center">
      <!-- Add a form with a hidden field to hold the timestamp -->
      <form method="post" action="{{ url_for('pls_page') }}" onsubmit="setConsentTime()">
        <input type="hidden" name="consent_timestamp" id="consentTimestamp" value="">
        <button id="agreeBtn" class="btn btn-primary" style="display: block;">Agree</button>
      </form>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  const pdfContainer = document.getElementById('pdfContainer');
  const agreeBtn = document.getElementById('agreeBtn');


  // Attach a timestamp to the hidden field before form submission
  function setConsentTime() {
    const consentField = document.getElementById('consentTimestamp');
    consentField.value = new Date().toISOString();
  }
</script>
{% endblock %}
